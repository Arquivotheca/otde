
INCDIR  =       @all_includes@ -I../.. -I..
CXXFLAGS=       $(INCDIR) @CXXFLAGS@ -DHAVE_CONFIG_H
LDFLAGS =       @all_libraries@ -lqt -lXext -lX11 -lkdecore @LIBSOCKET@
CXX     =       @CXX@
MOC     =       @MOC@

####### Files

SOURCES =	kioslave_ipc.cpp kioslave_ipc2.cpp main.cpp ipc.cpp protocol.cpp http.cpp file.cpp ftp.cpp manage.cpp
HEADERS =	kioslave_ipc.h main.h ipc.h protocol.h http.h file.h ftp.h manage.h
OBJECTS =	kioslave_ipc.o kioslave_ipc2.o main.o ipc.o protocol.o http.o file.o ftp.o manage.o debug.o
SRCMETA =	kioslave_ipc.moc main.moc
TARGET	=	kioslave

####### Implicit rules

.SUFFIXES: .cpp

.cpp.o:
	$(CXX) -c $(CXXFLAGS) $<

####### Build rules

all: $(TARGET)

Makefile: Makefile.in
	cd ../.. && CONFIG_FILES=kfm/kioslave/$@ CONFIG_HEADERS= $(SHELL) ./config.status 
$(TARGET): $(SRCMETA) $(OBJECTS)
	$(CXX) $(OBJECTS) -o $(TARGET) $(LDFLAGS)

debug.o: ../debug.cpp ../config-kfm.h
	$(CXX) $(CXXFLAGS) -c $<

depend:
	@makedepend $(INCDIR) $(SOURCES) 2> /dev/null

showfiles:
	@echo $(SOURCES) $(HEADERS) Makefile

clean:
	-rm -f *.o *.bak *~ *% #*
	-rm -f $(SRCMETA) $(TARGET)


####### Meta objects

kioslave_ipc.moc: kioslave_ipc.h
	$(MOC) kioslave_ipc.h -o kioslave_ipc.moc

main.moc: main.h
	$(MOC) main.h -o main.moc

# DO NOT DELETE THIS LINE -- make depend depends on it.


