<!doctype linuxdoc system>

<article>

<!-- Title information -->

<title>KDE Display Manager (KDM)
<author>Steffen Hansen, 
<tt><htmlurl url="mailto:stefh@dit.ou.dk" name="stefh@dit.ou.dk"></tt>
<date>Thu Oct 16 04:52:20 1997 -- Steffen Hansen
<abstract>
This document describes the KDE Display Manager
</abstract>

<!-- Table of contents -->
<toc>

<!-- Begin the document -->

<sect>Introduction

<p>
The KDE Display Manager is a ``drop-in'' replacement for xdm, the X
Display Manager and a little utility, kdmdesktop to draw nice
backgrounds. Kdm is superior to xdm in several ways:
<itemize>
<item>Kdm supports session arguments in a userfriendly way (xdm doesn't
tell the user, which args it might generate).
<item>Kdm has an optional ``shutdown''-button (much like NT's login
box).
<item>Kdm has an optional graphical view of users on the system (idea
stolen from IRIX' login box).
<item>Kdm looks way better than xdm ;-)
</itemize>

<sect>Installing kdm

<p>
See the file README! It will tell you how to compile kdm.
<bf/NOTE:/ <tt/make install/ will overwrite your previous <tt/kdmrc/.
<p>
Then you should insert the line
<tscreen><verb>kdmdesktop</verb></tscreen>
in the file called <tt/XSetup_0/ or similar in the xdm config directory
(often <tt>/etc/X11/xdm/XSetup_0</tt>). Make sure the path is set,
so that <tt/kdmdesktop/ can be executed.
<p>
PAM (Pluggable Authentication Modules) is a powerful and flexible
"plug-in" authentication system that comes with Solaris and RedHat Linux,
and has been ported to other systems.  PAM will handle shadow
passwords transparently.  If your system has PAM
installed, you can enable PAM support in KDE 
by compiling kdebase using ./configure --with-pam. 
See the file kdebase/README.pam for more information.
If you chose the PAM option,  you should check that the PAM service "xdm" 
has been configured. This will either be through a file /etc/pam.d/xdm, or 
by lines begining  with "xdm" in a file /etc/pam.conf.  A minimal 
configuration in /etc/pam.conf is provided by lines
<tscreen><verb>
# xdm authorization
xdm    auth       required     pam_unix_auth.so
xdm    account    required     pam_unix_acct.so
</verb></tscreen>
Besides "auth" and "account" entries, there may also be 
"password" and "session" entries;  see your PAM documentation.
While kdm uses the PAM service "xdm" by default, the name of
the PAM service can be changed when kdebase is compiled: for example
./configure --with-pam=kde will make kdm use a PAM service "kde".
In this example, /etc/pam.d/kde must exist (it can be a symlink to 
/etc/pam.d/xdm) or there must be valid "kde" entries in /etc/pam.conf.
kdm logins and logouts will generate entries in the system log,
identified by the name of the PAM service.
Note that kscreensaver will use the same PAM service for the "auth"
(password authentication) function, when unlocking the display;
authentication failures are logged in the system log.
<p>
Now it's time to test kdm. You should bring your system to a runlevel
that doesn't run xdm and try (as root) to say:
<tscreen><verb>
> kdm -nodaemon
</verb></tscreen>
If you get a kdm login box and you are able to log in, things are great.
The main thing that can go wrong here, is that the runtime linker might
not find the shared Qt or KDE libraries. When everything works, then edit
/etc/inittab to execute kdm instead of xdm. If you have a binary
distribution of the KDE libraries, make sure kdm is installed where
the libraries believe kde is installed.
If you dont like changing inittab,
you might instead rename xdm to xdm.bak and make xdm a symlink to kdm.
Kdm will read the general display manager settings from the xdm configuartion
files and the kdm specific ones from the file
&dollar;KDEDIR/share/config/kdmrc. Kdmdesktop will also read kdmrc.

<sect>Configuring kdm

<p>
There is a graphical tool for configuring kdm. You will find it under
the menu K/Settings/Applications/. With this tool you can configure the
kdm specific options (stored in kdmrc), but kdm still has to be set up properly just like
xdm,
so please read on.
<p>
If you have xdm installed, you probably dont need to modify your
Xsession script, but take a look at the files in the "samples" directory
anyway -- they show how to use kdm's session argument feature.
<p>
The kdm-specific option are configured by editing the file
"&dollar;KDEDIR/share/config/kdmrc". There are two sections in kdmrc:

<sect1>KDM

<p>
The keys in this section are
<tscreen><verb>
StdFont
FailFont
GreetFont
GreetString
SessionTypes
LogoPixmap
ShutdownButton
Shutdown
Restart
UserView
Users
NoUsers
SortUsers
GUIStyle
</verb></tscreen>

A short description of the keys:
<descrip>
<tag/*Font/ is a fontsstring formatted like the ouput from xfontsel.
<tag/GreetString/ is the title of the kdm login window.
<tag/SessionTypes/ is a ``;'' separated list of session arguments. It
defaults to <tt/SessionTypes=kde;failsafe/. For more info on session
arguments, see the xdm file <tt/Xsession/.
<verb>[Insert example here!]</verb>
<tag/LogoPixmap/ Change this, if you dont like the logo.
<tag/ShutdownButton, Shutdown and Restart/ ShutdownButton controls when
the shutdown button is displayed and can be one of <tt/All/, <tt/None/,
<tt/RootOnly/ and <tt/ConsoleOnly/. Shutdown and Restart are the
commands to run on shutdown/restart. They default to <tt>/sbin/halt</tt>
and <tt>/sbin/reboot</tt>.
<tag/UserView/ If this is set to ``1'', a graphical view of users will
be displayed in the kdm window.
<tag/Users/ is a ``;'' separated list of usernames that will be
displayed in the graphical user view. If <tt>UserView</tt> is 1 and the
<tt>Users </tt>entry is missing, kdm will look for users in the password
file. The users displayed are those who have a real name beside their
loginname, a home directory and a default shell - the rest is
skipped. Kdm will look in &dollar;KDEDIR/share/apps/kdm/pics/users/
for an icon for each user. If there exists an icon named johndoe.xpm, kdm
will use that for displaying user johndoe, if not kdm will use default.xpm.
So if you have a little picture of every user on your system, just place
them in &dollar;KDEDIR/share/apps/kdm/pics/users/ and have great fun
logging in with kdm ;-) 
<bf>NOTE:</bf> Kdm is able to handle icons with different sizes, but it might
not be too pretty to use both very small and very large icons.
<tag/NoUsers/ is a ``;'' separated list of usernames that wont be
displayed. Use it to filter ``pseudo-users'' like <tt>sync</tt> and
<tt>shutdown</tt> from the user view.
<tag/SortUsers/ If set to ``0'', the list of users are displayed in the
order it was read. The default is to display users in sorted order.
<tag/GUIStyle/ can be either <tt/Motif/ or <tt/Windows/.
</descrip>

<sect1>KDMDESKTOP

<p>
This section controls the background. The keys are:
<tscreen><verb>
BackgroundPicture
BackgroundColor
BackgroundPictureTile
BackgroundPictureCenter
FancyBackground
</verb></tscreen>

The first is the path to an image, the second a named color and the
rest are booleans (<tt>0</tt> or <tt>1</tt>). Note that
<tt>FancyBackground=1</tt> looks nice, but is <bf>very</bf> slow.

<sect>Legal stuff

<p>
Kdm is derived from xdm, so how is the copyright? Kdm 0.1 was done by
Matthias Ettrich. All later version by Steffen Hansen
<tt><htmlurl url="mailto:stefh@dit.ou.dk" name="stefh@dit.ou.dk"></tt>

Kdm is free software. I'm not sure exactly how it's license is, because it
has a lot of code from xdm in it. Anyway, i have to state:

Kdm requires the Qt library, which is copyright Troll Tech AS.
Freely distributable programs may generally use Qt for free,
see the file README.QT for details. Anyone is allowed to change kdm and
redistribute the result as long as my name is mentioned.

And by the way: Kdm is provided as is with no warranty of any kind,
including the warranty of design, merchantability and fitness for a particular
purpose.
</article>
